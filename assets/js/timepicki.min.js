(function(b){b.fn.timepicki=function(q){var f=b.extend({},{format_output:function(b,e,m){if(f.show_meridian)return b=Math.min(Math.max(parseInt(b),1),12),10>b&&(b="0"+b),e=Math.min(Math.max(parseInt(e),0),59),10>e&&(e="0"+e),b+":"+e+" "+m;b=Math.min(Math.max(parseInt(b),0),23);10>b&&(b="0"+b);e=Math.min(Math.max(parseInt(e),0),59);10>e&&(e="0"+e);e=Math.min(Math.max(parseInt(e),0),59);return b+":"+e},increase_direction:"up",custom_classes:"",min_hour_value:1,max_hour_value:12,show_meridian:!0,step_size_hours:"1",
step_size_minutes:"1",overflow_minutes:!1,disable_keyboard_mobile:!1,reset:!1,on_change:null},q);return this.each(function(){function u(c){return b.contains(n[0],c[0])||n.is(c)}function e(c,b){var a=d.find(".ti_tx input").val(),k=d.find(".mi_tx input").val(),e="";f.show_meridian&&(e=d.find(".mer_tx input").val());0===a.length||0===k.length||f.show_meridian&&0===e.length||(g.attr("data-timepicki-tim",a),g.attr("data-timepicki-mini",k),f.show_meridian?(g.attr("data-timepicki-meri",e),g.val(f.format_output(a,
k,e))):g.val(f.format_output(a,k)));if(null!==f.on_change)f.on_change(g[0]);b&&d.fadeOut()}function m(){q(f.start_time);d.fadeIn();var c=d.find("input:visible").first();c.focus();var k=function(a){if(9===a.which&&a.shiftKey){c.off("keydown",k);a=b(":input:visible:not(.timepicki-input)");var d=a.index(g);a.get(d-1).focus()}};c.on("keydown",k)}function q(c){var b;if(g.is("[data-timepicki-tim]")){var a=Number(g.attr("data-timepicki-tim"));var e=Number(g.attr("data-timepicki-mini"));f.show_meridian&&
(b=g.attr("data-timepicki-meri"))}else"object"===typeof c?(a=Number(c[0]),e=Number(c[1]),f.show_meridian&&(b=c[2])):(c=new Date,a=c.getHours(),e=c.getMinutes(),b="AM",f.show_meridian&&(0==a?a=12:12==a?b="PM":12<a&&(a-=12,b="PM")));10>a?d.find(".ti_tx input").val("0"+a):d.find(".ti_tx input").val(a);10>e?d.find(".mi_tx input").val("0"+e):d.find(".mi_tx input").val(e);f.show_meridian&&(10>b?d.find(".mer_tx input").val("0"+b):d.find(".mer_tx input").val(b))}function p(c,b){var a=Number(d.find(".time .ti_tx input").val()),
e=Number(f.min_hour_value),k=Number(f.max_hour_value),g=Number(f.step_size_hours);if(c&&c.hasClass("action-next")||"next"===b)a+g>k?(a=e,a=10>a?"0"+a:String(a)):(a+=g,10>a&&(a="0"+a)),d.find(".time .ti_tx input").val(a);else if(c&&c.hasClass("action-prev")||"prev"===b)a-g<Number(f.min_hour_value)?(a=k,a=10>a?"0"+a:String(a)):(a-=g,10>a&&(a="0"+a)),d.find(".time .ti_tx input").val(a)}function v(c,b){var a=Number(d.find(".mins .mi_tx input").val()),e=Number(f.step_size_minutes);if(c&&c.hasClass("action-next")||
"next"===b)59<a+e?(d.find(".mins .mi_tx input").val("00"),f.overflow_minutes&&p(null,"next")):(a+=e,10>a?d.find(".mins .mi_tx input").val("0"+a):d.find(".mins .mi_tx input").val(a));else if(c&&c.hasClass("action-prev")||"prev"===b)-1>=a-e?(d.find(".mins .mi_tx input").val(60-e),f.overflow_minutes&&p(null,"prev")):(a-=e,10>a?d.find(".mins .mi_tx input").val("0"+a):d.find(".mins .mi_tx input").val(a))}function w(c,b){var a=d.find(".meridian .mer_tx input").val();if(c&&c.hasClass("action-next")||"next"===
b)"AM"==a?d.find(".meridian .mer_tx input").val("PM"):d.find(".meridian .mer_tx input").val("AM");else if(c&&c.hasClass("action-prev")||"prev"===b)"AM"==a?d.find(".meridian .mer_tx input").val("PM"):d.find(".meridian .mer_tx input").val("AM")}var g=b(this),r=g.outerHeight(),r=r+10;b(g).wrap("<div class='time_pick'>");var n=b(this).parents(".time_pick"),h="down"===f.increase_direction?"<div class='prev action-prev'></div>":"<div class='prev action-next'></div>",l="down"===f.increase_direction?"<div class='next action-next'></div>":
"<div class='next action-prev'></div>",t=b("<div class='timepicker_wrap "+f.custom_classes+"'><div class='arrow_top'></div><div class='time'>"+h+"<div class='ti_tx'><input type='text' class='timepicki-input'"+(f.disable_keyboard_mobile?"readonly":"")+"></div>"+l+"</div><div class='mins'>"+h+"<div class='mi_tx'><input type='text' class='timepicki-input'"+(f.disable_keyboard_mobile?"readonly":"")+"></div>"+l+"</div>");f.show_meridian&&t.append("<div class='meridian'>"+h+"<div class='mer_tx'><input type='text' class='timepicki-input' readonly></div>"+
l+"</div>");f.reset&&t.append("<div><a href='#' class='reset_time'>Reset</a></div>");n.append(t);var d=b(this).next(".timepicker_wrap");d.find("div");h=n.find("input");b(".reset_time").on("click",function(b){g.val("");d.fadeOut()});b(".timepicki-input").keydown(function(c){if(13==c.keyCode)c.preventDefault(),e(),d.fadeOut();else{var g=b(this).parent().parent(),a=b(this),h=a.val();done=!1;setTimeout(function(){if(!done){var b=/^\d+$/.test(a.val()),d=""===a.val();g.hasClass("time")?b?(b=f.show_meridian?
Math.min(Math.max(parseInt(a.val()),1),12):Math.min(Math.max(parseInt(a.val()),0),23),a.val(b)):d||a.val(h):g.hasClass("mins")?b?(b=Math.min(Math.max(parseInt(a.val()),0),59),a.val(b)):d||a.val(h):g.hasClass("meridian")&&c.preventDefault();done=!0}},0)}});b(document).on("click",function(c){b(c.target).is(d)||"block"!=d.css("display")||b(c.target).is(b(".reset_time"))||(b(c.target).is(g)?(d.css({top:r+"px",left:"0px"}),m()):e(c,!u(b(c.target))))});g.on("focus",m);h.on("focus",function(){var c=b(this);
c.is(g)||c.select()});h.on("keydown",function(c){var d,a=b(this);38===c.which?d="down"===f.increase_direction?"prev":"next":40===c.which&&(d="down"===f.increase_direction?"next":"prev");a.closest(".timepicker_wrap .time").length?p(null,d):a.closest(".timepicker_wrap .mins").length?v(null,d):a.closest(".timepicker_wrap .meridian").length&&f.show_meridian&&w(null,d)});h.on("blur",function(){setTimeout(function(){var c=b(document.activeElement);c.is(":input")&&!u(c)&&(e(),d.fadeOut())},0)});h=d.find(".action-next");
l=d.find(".action-prev");b(l).add(h).on("click",function(){var c=b(this);"time"==c.parent().attr("class")?p(c):"mins"==c.parent().attr("class")?v(c):f.show_meridian&&w(c)})})}})(jQuery);